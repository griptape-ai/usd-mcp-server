<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>USDZ Viewer</title>
    <style>
      html, body { margin: 0; padding: 0; height: 100%; }
      body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background: #0b0b0c; color: #e5e7eb; }
      .wrap { display: flex; flex-direction: column; height: 100%; }
      header { padding: 12px 16px; border-bottom: 1px solid #1f2937; }
      header h1 { font-size: 16px; margin: 0; font-weight: 600; }
      .content { flex: 1; display: grid; place-items: center; padding: 12px; }
      .panel { width: min(1100px, 96%); background: #111216; border: 1px solid #1f2937; border-radius: 10px; overflow: hidden; }
      .panel .bar { display: flex; align-items: center; justify-content: space-between; padding: 8px 10px; border-bottom: 1px solid #1f2937; }
      .bar .src { color: #9ca3af; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 100%; }
      .viewer { aspect-ratio: 16 / 9; width: 100%; background: #0f1115; display: grid; place-items: center; position: relative; }
      #threeMount { position: absolute; inset: 0; }
      .note { padding: 10px; color: #9ca3af; font-size: 12px; border-top: 1px solid #1f2937; }
      .diag { width: min(1100px, 96%); margin: 16px auto; background: #0f1115; border: 1px dashed #374151; border-radius: 10px; }
      .diag header { display:flex; justify-content: space-between; align-items:center; padding: 8px 10px; border-bottom: 1px dashed #374151; }
      .diag pre { margin: 0; padding: 10px; color: #d1d5db; font-size: 12px; white-space: pre-wrap; word-break: break-word; max-height: 260px; overflow: auto; }
      .btn-secondary { color:#e5e7eb; background:#374151; text-decoration:none; padding:6px 8px; border-radius:6px; font-weight:600; }
      a.btn { color: #e5e7eb; background: #2563eb; text-decoration: none; padding: 8px 10px; border-radius: 6px; font-weight: 600; }
      iframe { width: 100%; height: 100%; border: 0; background: #0f1115; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <header><h1 id="title">USDZ Viewer</h1></header>
      <div class="content">
        <div class="panel">
          <div class="bar">
            <div class="src" id="srcLabel"></div>
          </div>
          <div class="viewer" id="viewer">
            <div id="threeMount"></div>
            <div id="overlay" style="position:absolute; inset:0; display:flex; align-items:center; justify-content:center; color:#9ca3af;">
              <span>Loading USDZâ€¦</span>
            </div>
          </div>
          <div class="note">This viewer renders USDZ in-browser using a WebAssembly decoder (TinyUSDZ).</div>
        </div>
      </div>
    </div>
    <div class="diag" id="diag">
      <header>
        <div>Diagnostics</div>
        <div>
          <a class="btn-secondary" id="reprobe">Re-run probe</a>
          <a class="btn-secondary" id="copyDiag">Copy</a>
        </div>
      </header>
      <pre id="log"></pre>
    </div>
    <script type="importmap">
      {
        "imports": {
          "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
          "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/",
          "tinyusdz/": "https://cdn.jsdelivr.net/gh/lighttransport/tinyusdz@release/web/js/src/tinyusdz/"
        }
      }
    </script>
    <script type="module">
      /*__INLINE_VIEWER_JS__*/
    </script>
  </body>
  </html>


